<!-- Floating Chat Button -->
<div *ngIf="showChat" class="chat-button" (click)="toggleChat()" [class.hidden]="isOpen">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
  </svg>
</div>

<!-- Chat Modal -->
<div *ngIf="showChat" class="chat-modal" [class.open]="isOpen">
  <div class="chat-header">
    <div class="header-content">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      <h3>Chat Assistant</h3>
    </div>
    <button class="close-button" (click)="closeChat()">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </div>

  <div class="chat-body">
    <div class="messages-container">
      <div *ngIf="messages.length === 0" class="empty-state">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
        <p>Start a conversation with our assistant</p>
      </div>

      <div *ngFor="let msg of messages" class="message" [class.user-message]="msg.sender === 'user'" [class.bot-message]="msg.sender === 'bot'">
        <div class="message-content">
          <p>{{ msg.text }}</p>
          <span class="timestamp">{{ msg.timestamp | date:'short' }}</span>
        </div>
      </div>

      <!-- Typing Indicator -->
      <div *ngIf="isLoading" class="message bot-message">
        <div class="message-content typing-indicator">
          <div class="typing-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="chat-footer">
    <form (ngSubmit)="sendMessage()" class="message-form">
      <input 
        type="text" 
        [(ngModel)]="message" 
        name="message"
        placeholder="Type your message..." 
        class="message-input"
        autocomplete="off"
      />
      <button type="submit" class="send-button" [disabled]="!message.trim()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="22" y1="2" x2="11" y2="13"></line>
          <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
        </svg>
      </button>
    </form>
  </div>
</div>

<!-- Backdrop -->
<div class="chat-backdrop" [class.visible]="isOpen" (click)="closeChat()"></div>
